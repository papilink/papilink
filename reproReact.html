<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ecualizador React en HTML</title>
    <style>
        body {
            background: #000;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: Arial, sans-serif;
        }
        
        #root {
            text-align: center;
        }
        
        canvas {
            border: 2px solid #1a1a1a;
            border-radius: 5px;
            box-shadow: 0 0 50px rgba(0, 0, 255, 0.2);
        }
        
        .controls {
            margin-top: 20px;
            color: #fff;
        }
        
        button {
            background: #003333;
            color: #00ffff;
            border: 1px solid #00ffff;
            padding: 10px 20px;
            cursor: pointer;
            margin: 0 5px;
            transition: all 0.3s;
        }
        
        button:hover {
            background: #006666;
        }
        
        input[type="range"] {
            width: 200px;
            margin: 0 10px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- Dependencias React -->
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

    <!-- Componente React -->
    <script type="text/babel">
        function AudioVisualizer() {
            const [isPlaying, setIsPlaying] = React.useState(false);
            const [volume, setVolume] = React.useState(0.7);
            
            const audioRef = React.useRef(null);
            const canvasRef = React.useRef(null);
            const analyserRef = React.useRef(null);
            const animationRef = React.useRef(null);

            React.useEffect(() => {
                const setupAudio = () => {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const analyser = audioContext.createAnalyser();
                    analyser.fftSize = 256;
                    
                    const source = audioContext.createMediaElementSource(audioRef.current);
                    source.connect(analyser);
                    analyser.connect(audioContext.destination);
                    
                    analyserRef.current = analyser;
                };

                if (audioRef.current) {
                    setupAudio();
                }

                return () => {
                    if (animationRef.current) {
                        cancelAnimationFrame(animationRef.current);
                    }
                };
            }, []);

            const draw = () => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                const analyser = analyserRef.current;
                
                const bufferLength = analyser.frequencyBinCount;
                const dataArray = new Uint8Array(bufferLength);
                analyser.getByteFrequencyData(dataArray);

                ctx.fillStyle = '#000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Gradiente rojo-azul
                const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
                gradient.addColorStop(0, '#ff0000');
                gradient.addColorStop(0.5, '#8a2be2');
                gradient.addColorStop(1, '#00008b');

                const barWidth = (canvas.width / bufferLength) * 2.5;
                let x = 0;

                for (let i = 0; i < bufferLength; i++) {
                    const barHeight = (dataArray[i] * 1.5) + 2;
                    
                    ctx.fillStyle = gradient;
                    ctx.fillRect(
                        x,
                        canvas.height - barHeight,
                        barWidth,
                        barHeight
                    );

                    x += barWidth + 1;
                }

                animationRef.current = requestAnimationFrame(draw);
            };

            const togglePlay = () => {
                if (isPlaying) {
                    audioRef.current.pause();
                } else {
                    audioRef.current.play();
                    draw();
                }
                setIsPlaying(!isPlaying);
            };

            const handleVolumeChange = (e) => {
                const newVolume = parseFloat(e.target.value);
                setVolume(newVolume);
                audioRef.current.volume = newVolume;
            };

            return (
                <div>
                    <canvas 
                        ref={canvasRef} 
                        width="800" 
                        height="400"
                    />
                    
                    <audio
                        ref={audioRef}
                        src="lights.mp3"
                        loop
                    />
                    
                    <div className="controls">
                        <button onClick={togglePlay}>
                            {isPlaying ? '⏸' : '▶'}
                        </button>
                        
                        <input
                            type="range"
                            min="0"
                            max="1"
                            step="0.1"
                            value={volume}
                            onChange={handleVolumeChange}
                        />
                    </div>
                </div>
            );
        }

        ReactDOM.render(
            <AudioVisualizer />,
            document.getElementById('root')
        );
    </script>
</body>
</html>